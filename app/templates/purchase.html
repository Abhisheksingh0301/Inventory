{% extends "layout.html" %}

{% block title %}Products{% endblock %}

{% block content %}
<h2 class="text-2xl font-semibold mt-8 mb-4">Purchase History</h2>

<form method="POST" action="{{ url_for('main.purchase') }}">  <!-- Optional -->
  <table class="w-full border-collapse border border-gray-300">
    <thead class="bg-green-100">
      <tr>
        <th class="border px-4 py-2 text-left w-12">
          <input type="checkbox" onclick="toggleCheckboxes(this)" />
        </th>
        <th class="border px-4 py-2 text-left">ID</th>
        <th class="border px-4 py-2 text-left">Product</th>
        <th class="border px-4 py-2 text-left">Brand</th>
        <th class="border px-4 py-2 text-left">Size</th>
        <th class="border px-4 py-2 text-left">Quantity</th>
        <th class="border px-4 py-2 text-left">Price</th>
        <th class="border px-4 py-2 text-left">Date</th>
        <th class="border px-4 py-2 text-left w-32">QTY</th>
      </tr>
    </thead>
    <tbody>
      {% for purchase in purchases %}
      <tr class="hover:bg-green-50">
        <!-- Checkbox -->
        <td class="border px-4 py-2 text-center">
          <input type="checkbox" name="selected[]" value="{{ purchase.id }}">
        </td>

        <!-- Existing fields -->
        <td class="border px-4 py-2">{{ purchase.id }}</td>
        <td class="border px-4 py-2">{{ purchase.product_name }}</td>
        <td class="border px-4 py-2">{{ purchase.quantity }}</td>
        <td class="border px-4 py-2">â‚¹{{ "%.2f"|format(purchase.purchase_price) }}</td>
        <td class="border px-4 py-2">{{ purchase.purchase_date }}</td>

        <!-- Quantity Input -->
        <td class="border px-4 py-2">
          <input type="number" name="new_quantity_{{ purchase.id }}" min="1"
            class="w-full border rounded px-2 py-1 bg-yellow-100 focus:bg-white transition-colors duration-200"
            placeholder="Qty" />
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="9" class="border px-4 py-2 text-center">No purchases yet.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Optional Submit Button for Quantity Update -->
  <div class="mt-4">
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
      Update Quantities
    </button>
  </div>
</form>
{% endblock %}
